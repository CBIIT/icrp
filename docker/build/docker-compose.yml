version: '2' 
services:
  web:
    build: .
    container_name: icrp-web-container
    depends_on:
     - db
    links:
     - db
    ports:
     - "80:80"
     - "443:443" 
    volumes:
     - ./drupal:/var/www/html
     - /etc/pki/generic/cert.pem:/etc/pki/tls/certs/localhost.crt:ro
     - /etc/pki/generic/privkey.pem:/etc/pki/tls/private/localhost.key:ro
  db:
    image: 'mysql:latest'
    container_name: icrp-mysql-container
    expose:
     - "3306"
    ports:
     - "3307:3306"
    environment:
     - MYSQL_ROOT_PASSWORD=temporary-root-password
     - MYSQL_DATABASE=drupal
     - MYSQL_USER=drupal
     - MYSQL_PASSWORD=drupal
    volumes:
     - /var/lib/mysql
     - ./icrp.sql:/tmp/icrp.sql
