<div class="search-criteria-summary" (click)="!showCriteriaLocked && showCriteria = !showCriteria">
  <span [ngClass]="{'glyphicon': true, 'glyphicon-triangle-right': !showCriteria, 'glyphicon-triangle-bottom': showCriteria}"></span>
  {{ searchCriteriaSummary }}</div>
<div class="search-criteria" *ngIf="showCriteria">
  {{ criteriaGroup | json }}

  <div *ngFor="let group of searchCriteriaGroups">
    <b>{{ group.category }}</b>

    <ul *ngIf="group.type === 'array'">
      <li *ngFor="let criteria of group.criteria">{{ criteria }}</li>
    </ul>

    <span *ngIf="group.type === 'single'">
      : {{ group.criteria[0] }}
    </span>

  </div>
</div>

<div class="row" style="margin-top: 10px">


  <div style="position: relative" *ngIf="loadingAnalytics">
  <div class="col-md-12 text-center clearfix loading-wrapper" style="padding-top: 140px; position: absolute" >
    Loading Charts...
  </div>
  </div>

  <div class="col-sm-3">
    <ui-chart
      label="Projects by Country"
      type="pie"
      [data]="(analytics && analytics.projects_by_country) || []">
    </ui-chart>
  </div>

  <div class="col-sm-3">
    <ui-chart
      label="Projects by CSO"
      type="pie"
      [data]="(analytics && analytics.projects_by_cso_research_area) || []">
    </ui-chart>
  </div>

  <div class="col-sm-3">
    <ui-chart
      label="Projects by Cancer Type"
      type="pie"
      [data]="(analytics && analytics.projects_by_cancer_type) || []"></ui-chart>
  </div>

  <div class="col-sm-3">
    <ui-chart
      label="Projects by Type"
      type="pie"
      [data]="(analytics && analytics.projects_by_type) || []"></ui-chart>
  </div>
</div>

<div class="row" *ngIf="authenticated && showExtendedCharts" style="margin-top: 10px">
  <div class="col-sm-12">
    <ui-chart
      label="Project Funding by Year"
      type="line"
      [data]="(analytics && analytics.projects_by_year) || []"></ui-chart>
  </div>
</div>

<div class="text-center" *ngIf="authenticated">
  <button class="btn btn-default btn-xs" (click)="showExtendedCharts = !showExtendedCharts" [disabled]="loadingAnalytics">
    Show {{showExtendedCharts ? 'Less' : 'More'}}
  </button>
</div>

<div class="row" style="margin-top: 8px; margin-bottom: 5px;">
  <email-results-button *ngIf="!authenticated"></email-results-button>
  <export-results-button *ngIf="!authenticated"></export-results-button>

  <email-results-partner-button *ngIf="authenticated"></email-results-partner-button>
  <export-results-partner-button *ngIf="authenticated"></export-results-partner-button>
  <export-results-single-partner-button *ngIf="authenticated"></export-results-single-partner-button>
  <export-results-abstracts-partner-button *ngIf="authenticated"></export-results-abstracts-partner-button>
  <export-results-abstracts-single-partner-button *ngIf="authenticated"></export-results-abstracts-single-partner-button>
  <export-results-graphs-partner-button *ngIf="authenticated"></export-results-graphs-partner-button>
</div>


<div class="row">
  <ui-table
    [data]="projectData"
    [columns]="projectColumns"
    [loading]="loading"
    [pageSizes]="[50, 100, 150, 200, 250, 300]"
    [numResults]="(analytics && analytics.count) || 0"
    (paginate)="paginate.emit($event)"
    (sort)="sort.emit($event)">
  </ui-table>
</div>